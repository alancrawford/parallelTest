#
#$ -cwd
#$ -o rmpi.out  
#$ -j y 
#$ -S /bin/bash 
#$ -N rmpi4
#$ -pe openmpi 4

tmphosts=`mktemp`
awk '{ for (i=0; i &lt; $2; ++i) { print $1} }' $PE_HOSTFILE > $tmphosts 

echo "Got $NSLOTS slots"
echo "jobid $JOB_ID"

module load openmpi/gcc/64/1.4.5
module load r/3.1.3

mpirun -np $NSLOTS -machinefile $tmphosts R --no-save -q < Rmpitest.R > rmpi.Rout
